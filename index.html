<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>買うか買わないか判定ツール</title>

<link rel="icon" type="image/x-icon" href="favicon.ico">
<link rel="apple-touch-icon" href="apple-touch-icon-180.png">
<link rel="icon" type="image/png" sizes="180x180" href="apple-touch-icon-180.png">

<style>
/* 基本：スマホでは普通に上から表示 */
body{
  margin:0;
  padding:16px;
  box-sizing:border-box;
  background:#fafafa;
  font-family: system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
}

/* カードUI（淡ベージュ系） */
.buy-card{
  --bg:#fffdf8; --fg:#1f2937; --muted:#6b7280; --border:#eadfd2; --chip:#faf5ee;
  --accent:#111827; --accent-2:#d97706; --accent-3:#10b981; --warn:#ef4444; --hold:#f59e0b;
  --shadow:0 10px 24px rgba(0,0,0,.06); --radius:14px; --ring:0 0 0 3px rgba(217,119,6,.25);

  max-width:720px;
  width:100%;
  margin:0 auto;               /* スマホは上から・横だけ中央 */
  background:var(--bg);
  color:var(--fg);
  border:1px solid var(--border);
  border-radius:var(--radius);
  padding:20px;
  box-shadow:var(--shadow);
}

/* タイトル背景つき */
.buy-card h3{
  margin:0 0 14px;
  font-size:20px; font-weight:700; letter-spacing:.2px;
  background:var(--chip);
  padding:8px 14px;
  border-radius:10px;
}
.buy-card p.lead{ margin:0 0 14px; font-size:14px; color:var(--muted); }
.buy-card label{ font-size:14px; display:block; }
.buy-card input[type="text"], .buy-card select, .buy-card input[type="range"]{
  width:100%; box-sizing:border-box; background:#fff; color:var(--fg);
  border:1px solid var(--border); border-radius:10px; padding:10px 12px; margin-top:6px;
  transition:border-color .2s, box-shadow .2s, background .2s;
}

/* ダークテーマ */
@media (prefers-color-scheme: dark){
  .buy-card{
    --bg:#0f1113; --fg:#e5e7eb; --muted:#a3a3a3; --border:#1f2937; --chip:#15181b;
    --accent:#e5e7eb; --ring:0 0 0 3px rgba(217,119,6,.35); --shadow:0 10px 24px rgba(0,0,0,.35);
  }
  .buy-card input[type="text"], .buy-card select, .buy-card input[type="range"]{ background:#0b0d10; }
}
.buy-card input[type="text"]:focus, .buy-card select:focus, .buy-card input[type="range"]:focus{
  outline:none; border-color:var(--accent-2); box-shadow:var(--ring);
}
.buy-card .grid{ display:grid; gap:12px; }
@media(min-width:560px){
  .buy-card .grid{ grid-template-columns:1fr 1fr; }
  .buy-card .grid > label:last-child{ grid-column:1 / -1; }
}
.buy-card .actions{
  display:flex; gap:10px; align-items:center; margin-top:12px; flex-wrap:wrap;
}
.buy-card button.primary{
  appearance:none; border:1px solid var(--accent); background:var(--accent); color:#fff;
  border-radius:10px; padding:10px 14px; cursor:pointer; font-weight:600; letter-spacing:.2px;
  transition:transform .05s ease, filter .2s ease, box-shadow .2s ease;
  box-shadow:0 6px 14px rgba(0,0,0,.12);
}
.buy-card button.primary:hover{ filter:brightness(1.05); }
.buy-card button.primary:active{ transform:translateY(1px); }
.buy-card button.ghost{
  appearance:none; border:1px solid var(--border); background:transparent;
  color:var(--fg); border-radius:10px; padding:8px 12px; cursor:pointer;
}
#result{
  display:none; margin-top:14px; padding:12px;
  background:var(--chip); border-radius:12px; line-height:1.6;
}
.badge{ display:inline-block; padding:2px 10px; border-radius:999px; font-size:12px; color:#fff; margin-right:8px; }
.b-buy{ background:var(--accent-3); } .b-hold{ background:var(--hold); } .b-no{ background:var(--warn); }
.history{
  margin-top:12px; border:1px solid var(--border); border-radius:12px; overflow:hidden;
}
.history summary{
  padding:10px 12px; background:var(--chip); border-bottom:1px solid var(--border); font-weight:600;
}
.history-list{ padding:10px 12px; font-size:14px; white-space:pre-wrap; }
.muted{ color:var(--muted); font-size:12px; margin-top:10px; }

/* ダークテーマでのスライダー＆ボタン */
@media (prefers-color-scheme: dark){
  input[type="range"]{ background:transparent; }
  input[type="range"]::-webkit-slider-runnable-track{
    background:#666; height:6px; border-radius:3px;
  }
  input[type="range"]::-webkit-slider-thumb{
    background:#fbbf24; width:16px; height:16px; border-radius:50%;
    margin-top:-5px; appearance:none;
  }
  input[type="range"]::-moz-range-track{
    background:#666; height:6px; border-radius:3px;
  }
  input[type="range"]::-moz-range-thumb{
    background:#fbbf24; width:16px; height:16px; border:none; border-radius:50%;
  }
  .buy-card button.primary{
    background:#f59e0b; border-color:#fbbf24; color:#000;
  }
  .buy-card button.primary:hover{ filter:brightness(1.1); }
}

/* 768px 以上の画面ではカードを画面ど真ん中に */
@media (min-width:768px){
  html, body{ height:100%; }
  body{
    min-height:100vh;
    display:flex;
    align-items:center;
    justify-content:center;
  }
  .buy-card{
    margin:0;          /* PC・タブレットでは上下も中央寄せ */
  }
}
</style>
</head>
<body>
<div id="buy-decider" class="buy-card" aria-describedby="desc-decider">
  <h3>買うか買わないか判定ツール</h3>
  <p id="desc-decider" class="lead">短いアンケートに答えると、買う/保留/買わないを提案します。</p>

  <label style="margin:8px 0 12px;">欲ちぃ物：
    <input id="itemName" type="text" placeholder="例：ひねり揚げ / ギニア製ドゥンドゥン用スティック" />
  </label>

  <div id="rational-form" style="border-top:1px dashed #eadfd2; padding-top:12px; margin-top:8px;">
    <div class="grid">
      <label>用途は一文で説明できるか？
        <select id="q1">
          <option value="2">はい（明確）</option>
          <option value="0">いいえ（曖昧）</option>
        </select>
      </label>
      <label>想定使用頻度は？
        <select id="q2">
          <option value="3">毎日</option>
          <option value="2">週に数回</option>
          <option value="1">月に数回</option>
          <option value="0">ほぼ使わない気がする</option>
        </select>
      </label>
      <label>代替・似たものは？
        <select id="q3">
          <option value="2">持っていない／代替がない</option>
          <option value="1">持っているが用途が違う</option>
          <option value="0">持っていて用途が被る</option>
        </select>
      </label>
      <label>予算への影響は？
        <select id="q4">
          <option value="2">余裕がある</option>
          <option value="1">少し厳しい</option>
          <option value="0">無理がある</option>
        </select>
      </label>
      <label>返品・再販の容易さは？
        <select id="q5">
          <option value="2">容易（返品可／中古相場が安定）</option>
          <option value="1">普通</option>
          <option value="0">困難（不可／相場不明）</option>
        </select>
      </label>
      <label>衝動レベル（直感の熱さ）
        <input id="q6" type="range" min="0" max="10" value="5"
               oninput="document.getElementById('q6v').textContent=this.value;">
        <span id="q6v">5</span>/10
      </label>
      <label>調査は十分か？（比較・レビュー確認）
        <select id="q7">
          <option value="2">はい（十分に調べた）</option>
          <option value="1">ある程度調べた</option>
          <option value="0">ほぼ調べていない</option>
        </select>
      </label>
      <label>使用タイミング（旬・期限の有無）
        <select id="q8">
          <option value="2">すぐ使う／旬を逃すと意味がない</option>
          <option value="1">そのうち使う</option>
          <option value="0">急がない</option>
        </select>
      </label>
    </div>
  </div>

  <div class="actions">
    <button id="decideBtn" class="primary">判定する</button>
  </div>

  <div id="result" role="status" aria-live="polite"></div>

  <details class="history">
    <summary>過去の判定（この端末のみ）</summary>
    <div id="history" class="history-list"></div>
    <div style="padding:0 12px 12px;">
      <button id="clearHistory" class="ghost" type="button">履歴を消す</button>
    </div>
  </details>

  <p class="muted">
    ※助言用のおもちゃです。最終決定はご自身でお願いいたします。<br>
    ※スコア60点以上で「買う」、40〜59点は「保留（24時間後に再判定）」、39点以下は「買わない」を提案します。
  </p>
  <p class="muted">
    【履歴保存について】この機能の判定履歴は、
    <strong>ご利用中の端末とブラウザ内（localStorage）</strong>にのみ保存されます。
  </p>
</div>

<script>
(function(){
  const root=document.getElementById('buy-decider');
  const btn=root.querySelector('#decideBtn');
  const result=root.querySelector('#result');
  const historyBox=root.querySelector('#history');
  const clearBtn=root.querySelector('#clearHistory');
  const itemInput=root.querySelector('#itemName');

  function loadHistory(){
    try{
      const a=JSON.parse(localStorage.getItem('buyDeciderHistory')||'[]');
      return Array.isArray(a)?a:[];
    }catch(e){return[];}
  }
  function saveHistory(entry){
    const a=loadHistory(); a.unshift(entry);
    localStorage.setItem('buyDeciderHistory', JSON.stringify(a.slice(0,50)));
  }
  function renderHistory(){
    const arr=loadHistory();
    historyBox.textContent =
      arr.length===0 ? '履歴はありません。' :
      arr.map(x=>{
        const t=new Date(x.ts).toLocaleString();
        return `${t}｜判定：${x.decision}${x.score!=null?`（${x.score}点）`:''}${x.item?`｜対象：${x.item}`:''}${x.note?`｜${x.note}`:''}`;
      }).join('\n');
  }

  function rationalScore(){
    const v=id=>Number((root.querySelector('#'+id)||{value:0}).value);
    const base = v('q1')+v('q2')+v('3')+v('q4')+v('q5')+v('q7')+v('q8');
  }
})();
</script>
</body>
</html>
